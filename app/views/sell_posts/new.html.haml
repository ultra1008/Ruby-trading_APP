= content_for :page_js do
  :javascript
    $(document).ready(function() {
      let lat = $("#sell_post_latitude");
      let lng = $("#sell_post_longitude");
      function getLocation() {
        console.log('getLocation called');
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(showPosition);
        } else {
          lat.val("Geolocation not supported. Enter manually");
          lng.val("Geolocation not supported. Enter manually");
        }
      }
      function showPosition(position) {
        console.log('showPosition called', position.coords.latitude, position.coords.longitude);
        lat.val(position.coords.latitude);
        lng.val(position.coords.longitude);
      }
      getLocation();
    });

= render 'partials/navbar'

%div{:class => "uk-section lta-section-header"}
  .uk-container.uk-text-center
    %h1 Sell Your Treasure

%div{:class => "uk-section"}
  %div{:class => "uk-container uk-container-small", "uk-height-viewport" => "expand: true"}

    = form_tag sell_posts_path, :method => "post", multipart: true do #points to buy_posts_path makes more sense| how does the data model look like?

      = label :sell_post, :title, 'Title'
      = text_field :sell_post, :title, class: 'form-control'
      %br

      = label :sell_post, :category, "Category"
      = text_field :sell_post, :category, class: 'form-control'
      = link_to 'Create a new template', new_template_path
      %br

      = label :sell_post, :price, 'Price'
      = text_field :sell_post, :price, class: 'form-control'
      %br

      = label :sell_post, :latitude, 'Latitude'
      = text_field :sell_post, :latitude, class: 'form-control'
      %br

      = label :sell_post, :longitude, 'Longitude'
      = text_field :sell_post, :longitude, class: 'form-control'
      %br

      = label :sell_post, :bargain_allowed, 'Do you want to bargain?', class: "form-label"
      %br

      = label :sell_post, :bargain_allowed, 'Yes'
      = radio_button :sell_post, :bargain_allowed, true
      = label :sell_post, :bargain_allowed, 'No'
      = radio_button :sell_post, :bargain_allowed, false
      %br

      = label :sell_post, :content, 'Content'
      = text_field :sell_post, :content, class: 'form-control'
      %br

      %div{:id => "post_detail"}
      %br

      = label :sell_post, :upload_image, 'Upload_Image'
      = file_field :sell_post, :upload_image, class: 'form-control-file'
      %br

      = submit_tag 'Post Your Item!', class: 'btn btn-primary btn-lg btn-block'

= render 'partials/footer'

:javascript
  // var x = document.getElementById("sell_post_latitude");
  // var y = document.getElementById("sell_post_longitude");
  // function showPosition(position) {
  //   console.log('showPosition called', position.coords.latitude, position.coords.longitude);
  //   x.value = position.coords.latitude;
  //   y.value = position.coords.longitude;
  // }
  // function getLocation() {
  //   if (navigator.geolocation) {
  //     navigator.geolocation.getCurrentPosition(showPosition);
  //   } else {
  //     x.innerHTML = "Geolocation is not supported by this browser. Enter manually";
  //     y.innerHTML = "Geolocation is not supported by this browser. Enter manually";
  //   }
  // }
  // getLocation();

  $('input#sell_post_category').on('change', function(event) {
    console.log('doing ajax');
    Rails.ajax({
      type: "Get",
      url: '/sell_posts/detail_form',
      data: 'category=' + $(this).val(),
      success: function(data) {
        console.log('response:', data);
        Rails.$("#post_detail")[0].innerHTML = data.html;
      }
    })
  })
